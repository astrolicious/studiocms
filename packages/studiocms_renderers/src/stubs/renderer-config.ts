import { fileFactory } from '@matthiesenxyz/integration-utils/fileFactory';
import { createResolver } from 'astro-integration-kit';

// Create resolver relative to this file
const { resolve } = createResolver(import.meta.url);

/**
 * Generate the `config.d.ts` file
 */
export const rendererConfigDTS = () => {
	const renderer = fileFactory();

	renderer.addLines('// This file is generated by StudioCMS\n\n');

	renderer.addLines(`declare module 'studiocms:renderer/config' {`);
	renderer.addLines(`const Config: import('${resolve('../index')}').StudioCMSRendererConfig;`);
	renderer.addLines('export default Config;');
	renderer.addLines('}');

	const rendererDTS = renderer.text();

	return rendererDTS;
};
