name: Deployment Helper Comment
permissions:
    pull-requests: write

on:
  pull_request:
    types: 
      - opened
      - ready_for_review

jobs:
    comment:
      name: Reply on new PR
      runs-on: ubuntu-latest
      if: ${{ github.pull_request.user.login != 'create-issue-branch[bot]' && github.pull_request.user.login != 'renovate[bot]' }}
      steps:
        - uses: actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea # v7
          with:
            script: |
              github.rest.issues.createComment({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: `@${context.payload.pull_request.user.login}, thank you for opening this pull request!

                The following links can be used to access the deployment previews:
                  - [PR Landing Page Deployment](https://pr${context.payload.pull_request.number}-www.astro-studiocms.xyz/)
                  - [PR Docs Deployment](https://pr${context.payload.pull_request.number}-docs.astro-studiocms.xyz/)
                  - [PR Demo/Testing Deployment](https://pr${context.payload.pull_request.number}-demo.astro-studiocms.xyz/)
                
                Preview deployments are automatically updated when changes are pushed to the PR. Please note that it may take a few minutes for the changes to be reflected on the preview sites as deployments are queued and processed in the order they are received.
                
                If you have any questions, feel free to ask!`
              })
  
